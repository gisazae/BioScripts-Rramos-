<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Computational Gene-finding &mdash; Bioinformatics 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/badge_only.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>
    <link rel="top" title="Bioinformatics 0.1 documentation" href="https://a-little-book-of-r-for-bioinformatics.readthedocs.org/en/latest/index.html" />
    <link rel="next" title="Comparative Genomics" href="chapter9.html" />
    <link rel="prev" title="REVISION EXERCISES 2" href="revisionexercises2.html" />
 
<!-- RTD Extra Head -->



<!-- 
Read the Docs is acting as the canonical URL for your project. 
If you want to change it, more info is available in our docs:
  http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://a-little-book-of-r-for-bioinformatics.readthedocs.org/en/latest/src/chapter7.html" />

<script type="text/javascript">
  // This is included here because other places don't have access to the pagename variable.
  var READTHEDOCS_DATA = {
    project: "a-little-book-of-r-for-bioinformatics",
    version: "latest",
    language: "en",
    page: "src/chapter7",
    builder: "sphinx",
    theme: "sphinxdoc",
    docroot: "/",
    source_suffix: ".rst",
    api_host: "https://readthedocs.org",
    commit: "8cd107b180ed964fe7c8021e78ff0ab528d5ba74"
  }
  // Old variables
  var doc_version = "latest";
  var doc_slug = "a-little-book-of-r-for-bioinformatics";
  var page_name = "src/chapter7";
  var html_theme = "sphinxdoc";
</script>
<!-- RTD Analytics Code -->
<!-- Included in the header because you don't have a footer block. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  // User Analytics Code
  _gaq.push(['user._setAccount', 'UA-36029021-1']);
  _gaq.push(['user._trackPageview']);
  // End User Analytics Code


  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- end RTD Analytics Code -->
<!-- end RTD <extrahead> -->

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="chapter9.html" title="Comparative Genomics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="revisionexercises2.html" title="REVISION EXERCISES 2"
             accesskey="P">previous</a> |</li>
        <li><a href="https://a-little-book-of-r-for-bioinformatics.readthedocs.org/en/latest/index.html">Bioinformatics 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="https://a-little-book-of-r-for-bioinformatics.readthedocs.org/en/latest/index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="chapter7.html#">Computational Gene-finding</a><ul>
<li><a class="reference internal" href="chapter7.html#the-genetic-code">The genetic code</a></li>
<li><a class="reference internal" href="chapter7.html#finding-start-and-stop-codons-in-a-dna-sequence">Finding start and stop codons in a DNA sequence</a></li>
<li><a class="reference internal" href="chapter7.html#reading-frames">Reading frames</a></li>
<li><a class="reference internal" href="chapter7.html#finding-open-reading-frames-on-the-forward-strand-of-a-dna-sequence">Finding open reading frames on the forward strand of a DNA sequence</a></li>
<li><a class="reference internal" href="chapter7.html#predicting-the-protein-sequence-for-an-orf">Predicting the protein sequence for an ORF</a></li>
<li><a class="reference internal" href="chapter7.html#finding-open-reading-frames-on-the-reverse-strand-of-a-dna-sequence">Finding open reading frames on the reverse strand of a DNA sequence</a></li>
<li><a class="reference internal" href="chapter7.html#lengths-of-open-reading-frames">Lengths of open reading frames</a></li>
<li><a class="reference internal" href="chapter7.html#identifying-significant-open-reading-frames">Identifying significant open reading frames</a></li>
<li><a class="reference internal" href="chapter7.html#summary">Summary</a></li>
<li><a class="reference internal" href="chapter7.html#links-and-further-reading">Links and Further Reading</a></li>
<li><a class="reference internal" href="chapter7.html#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="chapter7.html#exercises">Exercises</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="revisionexercises2.html"
                        title="previous chapter">REVISION EXERCISES 2</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="chapter9.html"
                        title="next chapter">Comparative Genomics</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="https://a-little-book-of-r-for-bioinformatics.readthedocs.org/en/latest/_sources/src/chapter7.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="https://a-little-book-of-r-for-bioinformatics.readthedocs.org/en/latest/search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="computational-gene-finding">
<h1>Computational Gene-finding<a class="headerlink" href="chapter7.html#computational-gene-finding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-genetic-code">
<h2>The genetic code<a class="headerlink" href="chapter7.html#the-genetic-code" title="Permalink to this headline">¶</a></h2>
<p>A protein-coding gene starts with an &#8220;ATG&#8221;, which is followed by an
integer (whole) number of codons (DNA triplets) that code for amino
acids, and ends with a &#8220;TGA&#8221;, &#8220;TAA&#8221;, or &#8220;TAG&#8221;. That is, the
<em>start codon</em> of a gene is always &#8220;ATG&#8221;, while the <em>stop codon</em> of
a gene can be &#8220;TGA&#8221;, &#8220;TAA&#8221; or &#8220;TAG&#8221;.</p>
<p>In R, you can view the <em>standard genetic code</em>, the correspondence
between codons and the amino acids that they are translated into,
by using the tablecode() function in the SeqinR package:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> <span class="kn">library</span><span class="p">(</span>seqinr<span class="p">)</span>
<span class="o">&gt;</span> tablecode<span class="p">()</span>
</pre></div>
</div>
<p><img alt="image2" src="../_images/P7_image1.png" /></p>
<p>You can see from this table that &#8220;ATG&#8221; is translated to Met (the
amino acid methionine), and that &#8220;TAA&#8221;, &#8220;TGA&#8221; and &#8220;TAG&#8221; correspond
to Stp (stop codons, which are not translated to any amino acid,
but signal the end of translation).</p>
</div>
<div class="section" id="finding-start-and-stop-codons-in-a-dna-sequence">
<h2>Finding start and stop codons in a DNA sequence<a class="headerlink" href="chapter7.html#finding-start-and-stop-codons-in-a-dna-sequence" title="Permalink to this headline">¶</a></h2>
<p>To look for all the potential start and stop codons in a DNA
sequence, we need to find all the &#8220;ATG&#8221;s, &#8220;TGA&#8221;s, &#8220;TAA&#8221;s, and
&#8220;TAG&#8221;s in the sequence.</p>
<p>To do this, we can use the &#8220;matchPattern()&#8221; function from the
Biostrings R package, which identifies all occurrences of a
particular motif (eg. &#8220;ATG&#8221;) in a sequence. As input, the
matchPattern() function requires that the sequences be in the form
of a string of single characters.</p>
<p>For example, we can look for all &#8220;ATG&#8221;s in the sequence
&#8220;AAAATGCAGTAACCCATGCCC&#8221; by typing:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> <span class="kn">library</span><span class="p">(</span><span class="s">&quot;Biostrings&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> s1 <span class="o">&lt;-</span> <span class="s">&quot;aaaatgcagtaacccatgccc&quot;</span>
<span class="o">&gt;</span> matchPattern<span class="p">(</span><span class="s">&quot;atg&quot;</span><span class="p">,</span> s1<span class="p">)</span> <span class="c1"># Find all ATGs in the sequence s1</span>
  Views on a <span class="m">21</span><span class="o">-</span>letter BString subject
subject<span class="o">:</span> aaaatgcagtaacccatgccc
views<span class="o">:</span>
    start end width
<span class="p">[</span><span class="m">1</span><span class="p">]</span>     <span class="m">4</span>   <span class="m">6</span>     <span class="m">3</span> <span class="p">[</span>atg<span class="p">]</span>
<span class="p">[</span><span class="m">2</span><span class="p">]</span>    <span class="m">16</span>  <span class="m">18</span>     <span class="m">3</span> <span class="p">[</span>atg<span class="p">]</span>
</pre></div>
</div>
<p>The output from matchPattern() tells us that there are two &#8220;ATG&#8221;s
in the sequence, at nucleotides 4-6, and at nucleotides 16-18. In
fact, we can see these by looking at the sequence
&#8220;AAAATGCAGTAACCCATGCCC&#8221;.</p>
<p>Similarly, if you use matchPattern() to find the positions of
&#8220;TAA&#8221;s, &#8220;TGA&#8221;s, and &#8220;TAG&#8221;s in the sequence &#8220;AAAATGCAGTAACCCATGCCC&#8221;,
you will find that it has one &#8220;TAA&#8221; at nucleotides 10-12, but no
&#8220;TAG&#8221;s or &#8220;TGA&#8221;s.</p>
<p>The following R function &#8220;findPotentialStartsAndStops()&#8221; can be used
to find all potential start and stop codons in a DNA
sequence:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> findPotentialStartsAndStops <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="kp">sequence</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="c1"># Define a vector with the sequences of potential start and stop codons</span>
     codons            <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;atg&quot;</span><span class="p">,</span> <span class="s">&quot;taa&quot;</span><span class="p">,</span> <span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="s">&quot;tga&quot;</span><span class="p">)</span>
     <span class="c1"># Find the number of occurrences of each type of potential start or stop codon</span>
     <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span>
     <span class="p">{</span>
        codon <span class="o">&lt;-</span> codons<span class="p">[</span>i<span class="p">]</span>
        <span class="c1"># Find all occurrences of codon &quot;codon&quot; in sequence &quot;sequence&quot;</span>
        occurrences <span class="o">&lt;-</span> matchPattern<span class="p">(</span>codon<span class="p">,</span> <span class="kp">sequence</span><span class="p">)</span>
        <span class="c1"># Find the start positions of all occurrences of &quot;codon&quot; in sequence &quot;sequence&quot;</span>
        codonpositions <span class="o">&lt;-</span> <span class="kp">attr</span><span class="p">(</span>occurrences<span class="p">,</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
        <span class="c1"># Find the total number of potential start and stop codons in sequence &quot;sequence&quot;</span>
        numoccurrences <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>codonpositions<span class="p">)</span>
        <span class="kr">if</span> <span class="p">(</span>i <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="c1"># Make a copy of vector &quot;codonpositions&quot; called &quot;positions&quot;</span>
           positions <span class="o">&lt;-</span> codonpositions
           <span class="c1"># Make a vector &quot;types&quot; containing &quot;numoccurrences&quot; copies of &quot;codon&quot;</span>
           types <span class="o">&lt;-</span> <span class="kp">rep</span><span class="p">(</span>codon<span class="p">,</span> numoccurrences<span class="p">)</span>
        <span class="p">}</span>
        <span class="kp">else</span>
        <span class="p">{</span>
           <span class="c1"># Add the vector &quot;codonpositions&quot; to the end of vector &quot;positions&quot;:</span>
           positions   <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>positions<span class="p">,</span> codonpositions<span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>positions<span class="p">))</span>
           <span class="c1"># Add the vector &quot;rep(codon, numoccurrences)&quot; to the end of vector &quot;types&quot;:</span>
           types       <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>types<span class="p">,</span> <span class="kp">rep</span><span class="p">(</span>codon<span class="p">,</span> numoccurrences<span class="p">),</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>types<span class="p">))</span>
        <span class="p">}</span>
     <span class="p">}</span>
     <span class="c1"># Sort the vectors &quot;positions&quot; and &quot;types&quot; in order of position along the input sequence:</span>
     indices <span class="o">&lt;-</span> <span class="kp">order</span><span class="p">(</span>positions<span class="p">)</span>
     positions <span class="o">&lt;-</span> positions<span class="p">[</span>indices<span class="p">]</span>
     types <span class="o">&lt;-</span> types<span class="p">[</span>indices<span class="p">]</span>
     <span class="c1"># Return a list variable including vectors &quot;positions&quot; and &quot;types&quot;:</span>
     mylist <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span>positions<span class="p">,</span>types<span class="p">)</span>
     <span class="kr">return</span><span class="p">(</span>mylist<span class="p">)</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>To use the function, you will need to copy and paste it into R.
For example, we can use this function to find potential
start and stop codons in sequence <em>s1</em>:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> s1 <span class="o">&lt;-</span> <span class="s">&quot;aaaatgcagtaacccatgccc&quot;</span>
<span class="o">&gt;</span> findPotentialStartsAndStops<span class="p">(</span>s1<span class="p">)</span>
<span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span>  <span class="m">4</span> <span class="m">10</span> <span class="m">16</span>

<span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;taa&quot;</span> <span class="s">&quot;atg&quot;</span>
</pre></div>
</div>
<p>The result of the function is returned as a list variable that
contains two elements: the first element of the list is a vector
containing the positions of potential start and stop codons in the
input sequence, and the second element of the list is a vector
containing the type of those start/stop codons (&#8220;atg&#8221;, &#8220;taa&#8221;,
&#8220;tag&#8221;, or &#8220;tga&#8221;).</p>
<p>The output for sequence <em>s1</em> tells us that
sequence <em>s1</em> has an &#8220;ATG&#8221; starting at nucleotide 4, a &#8220;TAA&#8221;
starting at nucleotide 10, and another &#8220;ATG&#8221; starting at nucleotide
16.</p>
<p>We can use the function findPotentialStartsAndStops() to find all
potential start and stop codons in longer sequences. For example,
say we want to find all potential start and stop codons in the
first 500 nucleotides of the genome sequence of the DEN-1 Dengue virus
(NCBI accession NC_001477).</p>
<p>In a <a class="reference external" href="chapter1.html#retrieving-genome-sequence-data-using-seqinr">previous chapter</a>, you
learnt that you can retrieve a sequence for an NCBI accession using the
&#8220;getncbiseq()&#8221; function. Thus, to retrieve the genome sequence of the DEN-1
Dengue virus (NCBI accession NC_001477), we can type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> dengueseq <span class="o">&lt;-</span> getncbiseq<span class="p">(</span><span class="s">&quot;NC_001477&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The variable <em>dengueseq</em> is a vector variable, and each letter in
the DEN-1 Dengue virus DNA sequence is stored in one element of
this vector.</p>
<p>Dengue virus causes <a class="reference external" href="http://apps.who.int/tdr/svc/diseases/dengue">Dengue fever</a>,
which is classified as a neglected tropical disease by the WHO.</p>
<p>To cut out the first 500 nucleotides of the
DEN-1 Dengue virus sequence, we can just take the first 500 elements of this
vector:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> dengueseqstart <span class="o">&lt;-</span> dengueseq<span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">500</span><span class="p">]</span> <span class="c1"># Take the first 500 nucleotides of the DEN-1 Dengue sequence</span>
<span class="o">&gt;</span> <span class="kp">length</span><span class="p">(</span>dengueseqstart<span class="p">)</span>             <span class="c1"># Find the length of the &quot;dengueseqstart&quot; start vector</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">500</span>
</pre></div>
</div>
<p>Next we want to find potential start and stop codons in the first
500 nucleotides of the Dengue virus sequence. We can do this using the
findPotentialStartsAndStops() function described above. However,
the findPotentialStartsAndStops() function requires that the input
sequence be in the format of a string of characters, rather than a
vector. Therefore, we first need to convert the vector
<em>dengueseqstart</em> into a string of characters. We can do that using
the c2s() function in the SeqinR package:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> <span class="kn">library</span><span class="p">(</span><span class="s">&quot;seqinr&quot;</span><span class="p">)</span>                 <span class="c1"># Load the SeqinR package</span>
<span class="o">&gt;</span> dengueseqstart                    <span class="c1"># Print out the vector dengueseqstart</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">20</span><span class="p">]</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">39</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">58</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">77</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">96</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">115</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span>
  <span class="p">[</span><span class="m">134</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">153</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span>
  <span class="p">[</span><span class="m">172</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">191</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span>
  <span class="p">[</span><span class="m">210</span><span class="p">]</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">229</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">248</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">267</span><span class="p">]</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">286</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span>
  <span class="p">[</span><span class="m">305</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">324</span><span class="p">]</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">343</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">362</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">381</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span>
  <span class="p">[</span><span class="m">400</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">419</span><span class="p">]</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span>
  <span class="p">[</span><span class="m">438</span><span class="p">]</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">457</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span>
  <span class="p">[</span><span class="m">476</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span>
  <span class="p">[</span><span class="m">495</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span>
<span class="o">&gt;</span> dengueseqstartstring <span class="o">&lt;-</span> c2s<span class="p">(</span>dengueseqstart<span class="p">)</span> <span class="c1"># Convert the vector &quot;dengueseqstart&quot; to a string of characters</span>
<span class="o">&gt;</span> dengueseqstartstring                        <span class="c1"># Print out the variable string of characters &quot;dengueseqstartstring&quot;</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;agttgttagtctacgtggaccgacaagaacagtttcgaatcggaagcttgcttaacgtagttctaacagttttttattagagagcagatctctgatgaacaaccaacggaaaaagacgggtcgaccgtctttcaatatgctgaaacgcgcgagaaaccgcgtgtcaactgtttcacagttggcgaagagattctcaaaaggattgctttcaggccaaggacccatgaaattggtgatggcttttatagcattcctaagatttctagccatacctccaacagcaggaattttggctagatggggctcattcaagaagaatggagcgatcaaagtgttacggggtttcaagaaagaaatctcaaacatgttgaacataatgaacaggaggaaaagatctgtgaccatgctcctcatgctgctgcccacagccctggcgttccatctgaccacccgagggggagagccgcacatgatagttagcaagcaggaaagaggaaaat&quot;</span>
</pre></div>
</div>
<p>We can then find potential start and stop codons in the first 500
nucleotides of the DEN-1 Dengue virus sequence by typing:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> findPotentialStartsAndStops<span class="p">(</span>dengueseqstartstring<span class="p">)</span>
  <span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span>   <span class="m">7</span>  <span class="m">53</span>  <span class="m">58</span>  <span class="m">64</span>  <span class="m">78</span>  <span class="m">93</span>  <span class="m">95</span>  <span class="m">96</span> <span class="m">137</span> <span class="m">141</span> <span class="m">224</span> <span class="m">225</span> <span class="m">234</span> <span class="m">236</span> <span class="m">246</span> <span class="m">255</span> <span class="m">264</span> <span class="m">295</span> <span class="m">298</span> <span class="m">318</span>
  <span class="p">[</span><span class="m">21</span><span class="p">]</span> <span class="m">365</span> <span class="m">369</span> <span class="m">375</span> <span class="m">377</span> <span class="m">378</span> <span class="m">399</span> <span class="m">404</span> <span class="m">413</span> <span class="m">444</span> <span class="m">470</span> <span class="m">471</span> <span class="m">474</span> <span class="m">478</span>
  <span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;tag&quot;</span> <span class="s">&quot;taa&quot;</span> <span class="s">&quot;tag&quot;</span> <span class="s">&quot;taa&quot;</span> <span class="s">&quot;tag&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;tga&quot;</span>
  <span class="p">[</span><span class="m">14</span><span class="p">]</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tag&quot;</span> <span class="s">&quot;taa&quot;</span> <span class="s">&quot;tag&quot;</span> <span class="s">&quot;tag&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;taa&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;tga&quot;</span>
  <span class="p">[</span><span class="m">27</span><span class="p">]</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;atg&quot;</span> <span class="s">&quot;tga&quot;</span> <span class="s">&quot;tag&quot;</span> <span class="s">&quot;tag&quot;</span>
</pre></div>
</div>
<p>We see that the lambda sequence has many different potential start
and stop codons, for example, a potential stop codon (TAG) at
nucleotide 7, a potential stop codon (TAA) at nucleotide 53, a
potential stop codon (TAG) at nucleotide 58, and so on.</p>
</div>
<div class="section" id="reading-frames">
<h2>Reading frames<a class="headerlink" href="chapter7.html#reading-frames" title="Permalink to this headline">¶</a></h2>
<p>Potential start and stop codons in a DNA sequence can be in three
different possible reading frames. A potential start/stop codon is
said to be in the <em>+1 reading frame</em> if there is an integer number
of triplets <em>x</em> between the first nucleotide of the sequence and
the start of the start/stop codon. Thus, a potential start/stop
codon that begins at nucleotides 1 (0 triplets), 4 (1 triplet), 7
(2 triplets)... will be in the +1 reading frame.</p>
<p>If there is an integer number of triplets <em>x</em>, plus one nucleotide
(ie. <em>x.3</em> triplets), between the first nucleotide of the sequence
and the start of the start/stop codon, then the start/stop codon is
said to be in the +2 reading frame. A potential start/stop codon
that begins at nucleotides 2 (0.3 triplets), 5 (1.3 triplets), 8
(2.3 triplets) ... is in the +2 reading frame.</p>
<p>Similarly, if there is an integer number of triplets <em>x</em>, plus two
nucleotides (ie. <em>x.6</em> triplets), between the first nucleotides of
the sequence and the start of the start/stop codon, the start/stop
codon is in the +3 reading frame. So a potential start/stop codon
that begins at nucleotides 3 (0.6 triplets), 6 (1.6 triplets), 9
(2.6 triplets)... is in the +3 reading frame.</p>
<p>For a potential start and stop codon to be part of the same gene,
they must be in the same reading frame.</p>
<p>From the output of findPotentialStartsAndStops() for the first 500
nucleotides of the genome of DEN-1 Dengue virus (see above), you can see that there is a
potential start codon (ATG) that starts at nucleotide 137, and a
potential stop codon (TGA) that starts at nucleotide 141. That is,
the potential start codon is from nucleotides 137-139 and the
potential stop codon is from nucleotides 141-143. Could the region
from nucleotides 137 to 143 possibly be a gene?</p>
<p>We can cut out the region from nucleotides 137 to 143 of the sequence
<em>dengueseqstartstring</em> to have a look, by using the substring()
function. If you look at the help page for the substring()
function, you will see that its arguments (inputs) are the name of
the variable containing the string of characters (ie., the DNA
sequence), and the coordinates of the substring that you want:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> <span class="kp">substring</span><span class="p">(</span>dengueseqstartstring<span class="p">,</span><span class="m">137</span><span class="p">,</span><span class="m">143</span><span class="p">)</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;atgctga&quot;</span>
</pre></div>
</div>
<p>If we look at the sequence from nucleotides 137-143,
&#8220;ATGCTGA&#8221;, we see that it starts with a potential
start codon (ATG) and ends with a potential stop codon (TGA).</p>
<p>However, the ribosome reads the sequence by scanning the codons
(triplets) one-by-one from left to right, and when we break up the
sequence into codons (triplets) we see that it does not contain an
integer (whole) number of triplets: &#8220;ATG CTG A&#8221;.</p>
<p>This means that even if the ribosome will not recognise the region
from 137-143 as a potential gene, as the ATG at nucleotide 137 is not
separated from the TGA at nucleotide 141 by an integer number of
codons. That is, this ATG and TGA are not in the same
<em>reading frame</em>, and so cannot be the start and stop codon of the
same gene.</p>
<p>The potential start codon at nucleotide 137 of the
<em>lambdaseqstartstring</em> sequence is in the +2 reading frame, as
there is an integer number of triplets, plus one nucleotide, between the start of the
sequence and the start of the start codon (ie. triplets 1-3, 4-6,
7-9, 10-12, 13-15, 16-18, 19-21, 22-24, 25-27, 28-30, ..., 133-135, and a single nucleotide 136).</p>
<p>However, the potential stop codon at nucleotide 141 is the +3
reading frame, as there are two nucleotides plus an integer number
of triplets between the start of the sequence and the start of the
stop codon (ie. triplets 1-3, 4-6, 7-9, 10-12, 13-15, 16-18, 19-21,
22-24, 25-27, 28-30, 31-33, 34-36, 37-39, 40-42, 43-45, ..., 133-135, 136-138, and two
nucleotides 139, 140).</p>
<p>As the potential start codon at nucleotide 137 and the potential
stop codon at nucleotide 141 are in different reading frames, they
are not separated by an integer number of codons, and therefore
cannot be part of the same gene.</p>
</div>
<div class="section" id="finding-open-reading-frames-on-the-forward-strand-of-a-dna-sequence">
<h2>Finding open reading frames on the forward strand of a DNA sequence<a class="headerlink" href="chapter7.html#finding-open-reading-frames-on-the-forward-strand-of-a-dna-sequence" title="Permalink to this headline">¶</a></h2>
<p>To find potential genes, we need to look for a potential start
codon, followed by an integer number of codons, followed by a
potential stop codon. This is eqivalent to looking for a potential
start codon followed by a potential stop codon that is in the same
reading frame. Such a stretch of DNA is known as an
<em>open reading frame</em> (ORF), and is a good candidate for a potential
gene.</p>
<p>The following function plotPotentialStartsAndStops() plots the potential start and
stop codons in the three different reading frames of a DNA
sequence:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> plotPotentialStartsAndStops <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="kp">sequence</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="c1"># Define a vector with the sequences of potential start and stop codons</span>
     codons <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;atg&quot;</span><span class="p">,</span> <span class="s">&quot;taa&quot;</span><span class="p">,</span> <span class="s">&quot;tag&quot;</span><span class="p">,</span> <span class="s">&quot;tga&quot;</span><span class="p">)</span>
     <span class="c1"># Find the number of occurrences of each type of potential start or stop codon</span>
     <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span>
     <span class="p">{</span>
        codon <span class="o">&lt;-</span> codons<span class="p">[</span>i<span class="p">]</span>
        <span class="c1"># Find all occurrences of codon &quot;codon&quot; in sequence &quot;sequence&quot;</span>
        occurrences <span class="o">&lt;-</span> matchPattern<span class="p">(</span>codon<span class="p">,</span> <span class="kp">sequence</span><span class="p">)</span>
        <span class="c1"># Find the start positions of all occurrences of &quot;codon&quot; in sequence &quot;sequence&quot;</span>
        codonpositions <span class="o">&lt;-</span> <span class="kp">attr</span><span class="p">(</span>occurrences<span class="p">,</span><span class="s">&quot;start&quot;</span><span class="p">)</span>
        <span class="c1"># Find the total number of potential start and stop codons in sequence &quot;sequence&quot;</span>
        numoccurrences <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>codonpositions<span class="p">)</span>
        <span class="kr">if</span> <span class="p">(</span>i <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="c1"># Make a copy of vector &quot;codonpositions&quot; called &quot;positions&quot;</span>
           positions   <span class="o">&lt;-</span> codonpositions
           <span class="c1"># Make a vector &quot;types&quot; containing &quot;numoccurrences&quot; copies of &quot;codon&quot;</span>
           types       <span class="o">&lt;-</span> <span class="kp">rep</span><span class="p">(</span>codon<span class="p">,</span> numoccurrences<span class="p">)</span>
        <span class="p">}</span>
        <span class="kp">else</span>
        <span class="p">{</span>
           <span class="c1"># Add the vector &quot;codonpositions&quot; to the end of vector &quot;positions&quot;:</span>
           positions   <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>positions<span class="p">,</span> codonpositions<span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>positions<span class="p">))</span>
           <span class="c1"># Add the vector &quot;rep(codon, numoccurrences)&quot; to the end of vector &quot;types&quot;:</span>
           types       <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>types<span class="p">,</span> <span class="kp">rep</span><span class="p">(</span>codon<span class="p">,</span> numoccurrences<span class="p">),</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>types<span class="p">))</span>
        <span class="p">}</span>
     <span class="p">}</span>
     <span class="c1"># Sort the vectors &quot;positions&quot; and &quot;types&quot; in order of position along the input sequence:</span>
     indices <span class="o">&lt;-</span> <span class="kp">order</span><span class="p">(</span>positions<span class="p">)</span>
     positions <span class="o">&lt;-</span> positions<span class="p">[</span>indices<span class="p">]</span>
     types <span class="o">&lt;-</span> types<span class="p">[</span>indices<span class="p">]</span>
     <span class="c1"># Make a plot showing the positions of the start and stop codons in the input sequence:</span>
     <span class="c1"># Draw a line at y=0 from 1 to the length of the sequence:</span>
     x  <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="kp">nchar</span><span class="p">(</span><span class="kp">sequence</span><span class="p">))</span>
     y <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
     plot<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> axes<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Nucleotide&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Reading frame&quot;</span><span class="p">,</span>
        main<span class="o">=</span><span class="s">&quot;Predicted start (red) and stop (blue) codons&quot;</span><span class="p">)</span>
     segments<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="kp">nchar</span><span class="p">(</span><span class="kp">sequence</span><span class="p">),</span><span class="m">1</span><span class="p">)</span>
     segments<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="kp">nchar</span><span class="p">(</span><span class="kp">sequence</span><span class="p">),</span><span class="m">2</span><span class="p">)</span>
     <span class="c1"># Add the x-axis at y=0:</span>
     axis<span class="p">(</span><span class="m">1</span><span class="p">,</span> pos<span class="o">=</span><span class="m">0</span><span class="p">)</span>
     <span class="c1"># Add the y-axis labels:</span>
     text<span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="s">&quot;+1&quot;</span><span class="p">)</span>
     text<span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">1.5</span><span class="p">,</span><span class="s">&quot;+2&quot;</span><span class="p">)</span>
     text<span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">2.5</span><span class="p">,</span><span class="s">&quot;+3&quot;</span><span class="p">)</span>
     <span class="c1"># Draw in each predicted start/stop codon:</span>
     numcodons <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>positions<span class="p">)</span>
     <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>numcodons<span class="p">)</span>
     <span class="p">{</span>
        position <span class="o">&lt;-</span> positions<span class="p">[</span>i<span class="p">]</span>
        type <span class="o">&lt;-</span> types<span class="p">[</span>i<span class="p">]</span>
        remainder <span class="o">&lt;-</span> <span class="p">(</span>position<span class="m">-1</span><span class="p">)</span> <span class="o">%%</span> <span class="m">3</span>
        <span class="kr">if</span>    <span class="p">(</span>remainder <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="c1"># +1 reading frame</span>
        <span class="p">{</span>
           <span class="kr">if</span> <span class="p">(</span>type <span class="o">==</span> <span class="s">&quot;atg&quot;</span><span class="p">)</span> <span class="p">{</span> segments<span class="p">(</span>position<span class="p">,</span><span class="m">0</span><span class="p">,</span>position<span class="p">,</span><span class="m">1</span><span class="p">,</span>lwd<span class="o">=</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span> <span class="p">}</span>
           <span class="kr">else</span>               <span class="p">{</span> segments<span class="p">(</span>position<span class="p">,</span><span class="m">0</span><span class="p">,</span>position<span class="p">,</span><span class="m">1</span><span class="p">,</span>lwd<span class="o">=</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)}</span>
        <span class="p">}</span>
        <span class="kr">else</span> <span class="kr">if</span> <span class="p">(</span>remainder <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="kr">if</span> <span class="p">(</span>type <span class="o">==</span> <span class="s">&quot;atg&quot;</span><span class="p">)</span> <span class="p">{</span> segments<span class="p">(</span>position<span class="p">,</span><span class="m">1</span><span class="p">,</span>position<span class="p">,</span><span class="m">2</span><span class="p">,</span>lwd<span class="o">=</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span> <span class="p">}</span>
           <span class="kr">else</span>               <span class="p">{</span> segments<span class="p">(</span>position<span class="p">,</span><span class="m">1</span><span class="p">,</span>position<span class="p">,</span><span class="m">2</span><span class="p">,</span>lwd<span class="o">=</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)}</span>
        <span class="p">}</span>
        <span class="kr">else</span> <span class="kr">if</span> <span class="p">(</span>remainder <span class="o">==</span> <span class="m">2</span><span class="p">)</span>
        <span class="p">{</span>
           <span class="kr">if</span> <span class="p">(</span>type <span class="o">==</span> <span class="s">&quot;atg&quot;</span><span class="p">)</span> <span class="p">{</span> segments<span class="p">(</span>position<span class="p">,</span><span class="m">2</span><span class="p">,</span>position<span class="p">,</span><span class="m">3</span><span class="p">,</span>lwd<span class="o">=</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span> <span class="p">}</span>
           <span class="kr">else</span>               <span class="p">{</span> segments<span class="p">(</span>position<span class="p">,</span><span class="m">2</span><span class="p">,</span>position<span class="p">,</span><span class="m">3</span><span class="p">,</span>lwd<span class="o">=</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)}</span>
        <span class="p">}</span>
     <span class="p">}</span>
   <span class="p">}</span>
</pre></div>
</div>
<p>To use this function, you will first need to copy and paste it into R.</p>
<p>For example, to plot the potential start and stop codons
in the first 500 nucleotides of the DEN-1 Dengue virus genome, we
type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> plotPotentialStartsAndStops<span class="p">(</span>dengueseqstartstring<span class="p">)</span>
</pre></div>
</div>
<p><img alt="image3" src="../_images/P7_image3b.png" /></p>
<p>In the picture produced by plotPotentialStartsAndStops(), the
x-axis represents the input sequence (<em>dengueseqstartstring</em> here).
The potential start codons are represented by vertical red lines,
and potential stop codons are represented by vertical blue lines.</p>
<p>Three different layers in the picture show potential start/stop
codons in the +1 reading frame (bottom layer), +2 reading frame
(middle layer), and +3 reading frame (top layer).</p>
<p>We can see that the start codon at nucleotide 137 is represented by
a vertical red line in the layer corresponding to the +2 reading
frame (middle layer). There are no potential stop codons in the +2
reading frame to the right of that start codon. Thus, the start codon
at nucleotide 137 does not seem to be part of an open reading frame.</p>
<p>We can see however that in the +3 reading frame (top layer) there is
a predicted start codon (red line) at position 318 and that this is
followed by a predicted stop codon (blue line) at position 371.
Thus, the region from nucleotides 318 to 371
could be a potential gene in the +3 reading frame. In other words,
the region from nucleotides 318 to 371 is an open reading frame, or
ORF.</p>
<p>The following function findORFsinSeq() finds ORFs in an input sequence:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> findORFsinSeq <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="kp">sequence</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="kn">require</span><span class="p">(</span>Biostrings<span class="p">)</span>
     <span class="c1"># Make vectors &quot;positions&quot; and &quot;types&quot; containing information on the positions of ATGs in the sequence:</span>
     mylist <span class="o">&lt;-</span> findPotentialStartsAndStops<span class="p">(</span><span class="kp">sequence</span><span class="p">)</span>
     positions <span class="o">&lt;-</span> mylist<span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
     types <span class="o">&lt;-</span> mylist<span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
     <span class="c1"># Make vectors &quot;orfstarts&quot; and &quot;orfstops&quot; to store the predicted start and stop codons of ORFs</span>
     orfstarts <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>
     orfstops <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>
     <span class="c1"># Make a vector &quot;orflengths&quot; to store the lengths of the ORFs</span>
     orflengths <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>
     <span class="c1"># Print out the positions of ORFs in the sequence:</span>
     <span class="c1"># Find the length of vector &quot;positions&quot;</span>
     numpositions <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>positions<span class="p">)</span>
     <span class="c1"># There must be at least one start codon and one stop codon to have an ORF.</span>
     <span class="kr">if</span> <span class="p">(</span>numpositions <span class="o">&gt;=</span> <span class="m">2</span><span class="p">)</span>
     <span class="p">{</span>
        <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="p">(</span>numpositions<span class="m">-1</span><span class="p">))</span>
        <span class="p">{</span>
           posi <span class="o">&lt;-</span> positions<span class="p">[</span>i<span class="p">]</span>
           typei <span class="o">&lt;-</span> types<span class="p">[</span>i<span class="p">]</span>
           found <span class="o">&lt;-</span> <span class="m">0</span>
           <span class="kr">while</span> <span class="p">(</span>found <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
           <span class="p">{</span>
              <span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="p">(</span>i<span class="m">+1</span><span class="p">)</span><span class="o">:</span>numpositions<span class="p">)</span>
              <span class="p">{</span>
                 posj  <span class="o">&lt;-</span> positions<span class="p">[</span>j<span class="p">]</span>
                 typej <span class="o">&lt;-</span> types<span class="p">[</span>j<span class="p">]</span>
                 posdiff <span class="o">&lt;-</span> posj <span class="o">-</span> posi
                 posdiffmod3 <span class="o">&lt;-</span> posdiff <span class="o">%%</span> <span class="m">3</span>
                 <span class="c1"># Add in the length of the stop codon</span>
                 orflength <span class="o">&lt;-</span> posj <span class="o">-</span> posi <span class="o">+</span> <span class="m">3</span>
                 <span class="kr">if</span> <span class="p">(</span>typei <span class="o">==</span> <span class="s">&quot;atg&quot;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>typej <span class="o">==</span> <span class="s">&quot;taa&quot;</span> <span class="o">||</span> typej <span class="o">==</span> <span class="s">&quot;tag&quot;</span> <span class="o">||</span> typej <span class="o">==</span> <span class="s">&quot;tga&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> posdiffmod3 <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
                 <span class="p">{</span>
                    <span class="c1"># Check if we have already used the stop codon at posj+2 in an ORF</span>
                    numorfs <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>orfstops<span class="p">)</span>
                    usedstop <span class="o">&lt;-</span> <span class="m">-1</span>
                    <span class="kr">if</span> <span class="p">(</span>numorfs <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span>
                    <span class="p">{</span>
                      <span class="kr">for</span> <span class="p">(</span>k <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>numorfs<span class="p">)</span>
                      <span class="p">{</span>
                          orfstopk <span class="o">&lt;-</span> orfstops<span class="p">[</span>k<span class="p">]</span>
                          <span class="kr">if</span> <span class="p">(</span>orfstopk <span class="o">==</span> <span class="p">(</span>posj <span class="o">+</span> <span class="m">2</span><span class="p">))</span> <span class="p">{</span> usedstop <span class="o">&lt;-</span> <span class="m">1</span> <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="kr">if</span> <span class="p">(</span>usedstop <span class="o">==</span> <span class="m">-1</span><span class="p">)</span>
                    <span class="p">{</span>
                       orfstarts <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>orfstarts<span class="p">,</span> posi<span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>orfstarts<span class="p">))</span>
                       orfstops <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>orfstops<span class="p">,</span> posj<span class="m">+2</span><span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>orfstops<span class="p">))</span> <span class="c1"># Including the stop codon.</span>
                       orflengths <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>orflengths<span class="p">,</span> orflength<span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>orflengths<span class="p">))</span>
                    <span class="p">}</span>
                    found <span class="o">&lt;-</span> <span class="m">1</span>
                    <span class="kr">break</span>
                 <span class="p">}</span>
                 <span class="kr">if</span> <span class="p">(</span>j <span class="o">==</span> numpositions<span class="p">)</span> <span class="p">{</span> found <span class="o">&lt;-</span> <span class="m">1</span> <span class="p">}</span>
              <span class="p">}</span>
           <span class="p">}</span>
        <span class="p">}</span>
     <span class="p">}</span>
     <span class="c1"># Sort the final ORFs by start position:</span>
     indices <span class="o">&lt;-</span> <span class="kp">order</span><span class="p">(</span>orfstarts<span class="p">)</span>
     orfstarts <span class="o">&lt;-</span> orfstarts<span class="p">[</span>indices<span class="p">]</span>
     orfstops <span class="o">&lt;-</span> orfstops<span class="p">[</span>indices<span class="p">]</span>
     <span class="c1"># Find the lengths of the ORFs that we have</span>
     orflengths <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>
     numorfs <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>orfstarts<span class="p">)</span>
     <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>numorfs<span class="p">)</span>
     <span class="p">{</span>
        orfstart <span class="o">&lt;-</span> orfstarts<span class="p">[</span>i<span class="p">]</span>
        orfstop <span class="o">&lt;-</span> orfstops<span class="p">[</span>i<span class="p">]</span>
        orflength <span class="o">&lt;-</span> orfstop <span class="o">-</span> orfstart <span class="o">+</span> <span class="m">1</span>
        orflengths <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>orflengths<span class="p">,</span>orflength<span class="p">,</span>after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>orflengths<span class="p">))</span>
     <span class="p">}</span>
     mylist <span class="o">&lt;-</span> <span class="kt">list</span><span class="p">(</span>orfstarts<span class="p">,</span> orfstops<span class="p">,</span> orflengths<span class="p">)</span>
     <span class="kr">return</span><span class="p">(</span>mylist<span class="p">)</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>You will need to copy and paste this function into R before you can use it.
For example, we can use it to find all ORFs in the sequence <em>s1</em>:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> s1 <span class="o">&lt;-</span> <span class="s">&quot;aaaatgcagtaacccatgccc&quot;</span>
<span class="o">&gt;</span> findORFsinSeq<span class="p">(</span>s1<span class="p">)</span>
<span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">4</span>

<span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">12</span>

<span class="p">[[</span><span class="m">3</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">9</span>
</pre></div>
</div>
<p>The function findORFsinSeq() returns a list variable, where the
first element of the list is a vector of the start positions of
ORFs, the second element of the list is a vector of the end
positions of those ORFs, and the third element is a vector
containing the lengths of the ORFs.</p>
<p>The output for the
findORFsinSeq() function for <em>s1</em> tells us that there is one ORF in
the sequence <em>s1</em>, and that the predicted start codon starts at
nucleotide 4 in the sequence, and that the predicted stop codon
ends at nucleotide 12 in the sequence.</p>
<p>We can use the function findORFsinSeq() to find the ORFs in the
first 500 nucleotides of the DEN-1 Dengue virus genome sequence
by typing:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> findORFsinSeq<span class="p">(</span>dengueseqstartstring<span class="p">)</span>
  <span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">298</span> <span class="m">318</span>
  <span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">480</span> <span class="m">371</span>
  <span class="p">[[</span><span class="m">3</span><span class="p">]]</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">183</span>  <span class="m">54</span>
</pre></div>
</div>
<p>The result from findORFsinSeq() indicates that there are two ORFs
in the first 500 nucleotides of the DEN-1 Dengue virus genome, at nucleotides
298-480 (start codon at 298-300, stop codon at 478-480), and 318-371 (start codon
at 318-320, stop codon at 369-371).</p>
<p>The following function &#8220;plotORFsinSeq()&#8221; plots the positions of ORFs in a sequence:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> plotORFsinSeq <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="kp">sequence</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="c1"># Make vectors &quot;positions&quot; and &quot;types&quot; containing information on the positions of ATGs in the sequence:</span>
     mylist <span class="o">&lt;-</span> findPotentialStartsAndStops<span class="p">(</span><span class="kp">sequence</span><span class="p">)</span>
     positions <span class="o">&lt;-</span> mylist<span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
     types <span class="o">&lt;-</span> mylist<span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
     <span class="c1"># Make vectors &quot;orfstarts&quot; and &quot;orfstops&quot; to store the predicted start and stop codons of ORFs</span>
     orfstarts <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>
     orfstops <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>
     <span class="c1"># Make a vector &quot;orflengths&quot; to store the lengths of the ORFs</span>
     orflengths <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>
     <span class="c1"># Print out the positions of ORFs in the sequence:</span>
     numpositions <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>positions<span class="p">)</span> <span class="c1"># Find the length of vector &quot;positions&quot;</span>
     <span class="c1"># There must be at least one start codon and one stop codon to have an ORF.</span>
     <span class="kr">if</span> <span class="p">(</span>numpositions <span class="o">&gt;=</span> <span class="m">2</span><span class="p">)</span>
     <span class="p">{</span>
        <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="p">(</span>numpositions<span class="m">-1</span><span class="p">))</span>
        <span class="p">{</span>
           posi <span class="o">&lt;-</span> positions<span class="p">[</span>i<span class="p">]</span>
           typei <span class="o">&lt;-</span> types<span class="p">[</span>i<span class="p">]</span>
           found <span class="o">&lt;-</span> <span class="m">0</span>
           <span class="kr">while</span> <span class="p">(</span>found <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
           <span class="p">{</span>
              <span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="p">(</span>i<span class="m">+1</span><span class="p">)</span><span class="o">:</span>numpositions<span class="p">)</span>
              <span class="p">{</span>
                 posj <span class="o">&lt;-</span> positions<span class="p">[</span>j<span class="p">]</span>
                 typej <span class="o">&lt;-</span> types<span class="p">[</span>j<span class="p">]</span>
                 posdiff <span class="o">&lt;-</span> posj <span class="o">-</span> posi
                 posdiffmod3 <span class="o">&lt;-</span> posdiff <span class="o">%%</span> <span class="m">3</span>
                 orflength <span class="o">&lt;-</span> posj <span class="o">-</span> posi <span class="o">+</span> <span class="m">3</span> <span class="c1"># Add in the length of the stop codon</span>
                 <span class="kr">if</span> <span class="p">(</span>typei <span class="o">==</span> <span class="s">&quot;atg&quot;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>typej <span class="o">==</span> <span class="s">&quot;taa&quot;</span> <span class="o">||</span> typej <span class="o">==</span> <span class="s">&quot;tag&quot;</span> <span class="o">||</span> typej <span class="o">==</span> <span class="s">&quot;tga&quot;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> posdiffmod3 <span class="o">==</span> <span class="m">0</span><span class="p">)</span>
                 <span class="p">{</span>
                    <span class="c1"># Check if we have already used the stop codon at posj+2 in an ORF</span>
                    numorfs <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>orfstops<span class="p">)</span>
                    usedstop <span class="o">&lt;-</span> <span class="m">-1</span>
                    <span class="kr">if</span> <span class="p">(</span>numorfs <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span>
                    <span class="p">{</span>
                       <span class="kr">for</span> <span class="p">(</span>k <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>numorfs<span class="p">)</span>
                       <span class="p">{</span>
                          orfstopk <span class="o">&lt;-</span> orfstops<span class="p">[</span>k<span class="p">]</span>
                          <span class="kr">if</span> <span class="p">(</span>orfstopk <span class="o">==</span> <span class="p">(</span>posj <span class="o">+</span> <span class="m">2</span><span class="p">))</span> <span class="p">{</span> usedstop <span class="o">&lt;-</span> <span class="m">1</span> <span class="p">}</span>
                       <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="kr">if</span> <span class="p">(</span>usedstop <span class="o">==</span> <span class="m">-1</span><span class="p">)</span>
                    <span class="p">{</span>
                       orfstarts <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>orfstarts<span class="p">,</span> posi<span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>orfstarts<span class="p">))</span>
                       orfstops <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>orfstops<span class="p">,</span> posj<span class="m">+2</span><span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>orfstops<span class="p">))</span> <span class="c1"># Including the stop codon.</span>
                       orflengths <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>orflengths<span class="p">,</span> orflength<span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>orflengths<span class="p">))</span>
                    <span class="p">}</span>
                    found <span class="o">&lt;-</span> <span class="m">1</span>
                    <span class="kr">break</span>
                 <span class="p">}</span>
                 <span class="kr">if</span> <span class="p">(</span>j <span class="o">==</span> numpositions<span class="p">)</span> <span class="p">{</span> found <span class="o">&lt;-</span> <span class="m">1</span> <span class="p">}</span>
              <span class="p">}</span>
           <span class="p">}</span>
        <span class="p">}</span>
     <span class="p">}</span>
     <span class="c1"># Sort the final ORFs by start position:</span>
     indices <span class="o">&lt;-</span> <span class="kp">order</span><span class="p">(</span>orfstarts<span class="p">)</span>
     orfstarts <span class="o">&lt;-</span> orfstarts<span class="p">[</span>indices<span class="p">]</span>
     orfstops <span class="o">&lt;-</span> orfstops<span class="p">[</span>indices<span class="p">]</span>
     <span class="c1"># Make a plot showing the positions of ORFs in the input sequence:</span>
     <span class="c1"># Draw a line at y=0 from 1 to the length of the sequence:</span>
     x <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="kp">nchar</span><span class="p">(</span><span class="kp">sequence</span><span class="p">))</span>
     y <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
     plot<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">),</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> axes<span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&quot;Nucleotide&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Reading frame&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Predicted ORFs&quot;</span><span class="p">)</span>
     segments<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="kp">nchar</span><span class="p">(</span><span class="kp">sequence</span><span class="p">),</span><span class="m">1</span><span class="p">)</span>
     segments<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="kp">nchar</span><span class="p">(</span><span class="kp">sequence</span><span class="p">),</span><span class="m">2</span><span class="p">)</span>
     <span class="c1"># Add the x-axis at y=0:</span>
     axis<span class="p">(</span><span class="m">1</span><span class="p">,</span> pos<span class="o">=</span><span class="m">0</span><span class="p">)</span>
     <span class="c1"># Add the y-axis labels:</span>
     text<span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="s">&quot;+1&quot;</span><span class="p">)</span>
     text<span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">1.5</span><span class="p">,</span><span class="s">&quot;+2&quot;</span><span class="p">)</span>
     text<span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">2.5</span><span class="p">,</span><span class="s">&quot;+3&quot;</span><span class="p">)</span>
     <span class="c1"># Make a plot of the ORFs in the sequence:</span>
     numorfs <span class="o">&lt;-</span> <span class="kp">length</span><span class="p">(</span>orfstarts<span class="p">)</span>
     <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>numorfs<span class="p">)</span>
     <span class="p">{</span>
        orfstart <span class="o">&lt;-</span> orfstarts<span class="p">[</span>i<span class="p">]</span>
        orfstop <span class="o">&lt;-</span> orfstops<span class="p">[</span>i<span class="p">]</span>
        remainder <span class="o">&lt;-</span> <span class="p">(</span>orfstart<span class="m">-1</span><span class="p">)</span> <span class="o">%%</span> <span class="m">3</span>
        <span class="kr">if</span>    <span class="p">(</span>remainder <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="c1"># +1 reading frame</span>
        <span class="p">{</span>
           rect<span class="p">(</span>orfstart<span class="p">,</span><span class="m">0</span><span class="p">,</span>orfstop<span class="p">,</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;cyan&quot;</span><span class="p">,</span>border<span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="kr">else</span> <span class="kr">if</span> <span class="p">(</span>remainder <span class="o">==</span> <span class="m">1</span><span class="p">)</span>
        <span class="p">{</span>
           rect<span class="p">(</span>orfstart<span class="p">,</span><span class="m">1</span><span class="p">,</span>orfstop<span class="p">,</span><span class="m">2</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;cyan&quot;</span><span class="p">,</span>border<span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="kr">else</span> <span class="kr">if</span> <span class="p">(</span>remainder <span class="o">==</span> <span class="m">2</span><span class="p">)</span>
        <span class="p">{</span>
           rect<span class="p">(</span>orfstart<span class="p">,</span><span class="m">2</span><span class="p">,</span>orfstop<span class="p">,</span><span class="m">3</span><span class="p">,</span>col<span class="o">=</span><span class="s">&quot;cyan&quot;</span><span class="p">,</span>border<span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span>
        <span class="p">}</span>
     <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>To use this function, you will first need to copy and paste it into R.
You can then use this function to plot the positions of the ORFs in
<em>dengueseqstartstring</em> by typing:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> plotORFsinSeq<span class="p">(</span>dengueseqstartstring<span class="p">)</span>
</pre></div>
</div>
<p><img alt="image4" src="../_images/P7_image4.png" /></p>
<p>The picture produced by plotORFsinSeq() represents the two ORFs in
the first 500 nucleotides of the lambda genome as blue rectangles.</p>
<p>One of the ORFs is in the +3 reading frame, and one is in the
+1 reading frame. There are no ORFs in the +2 reading frame, as
there are no potential stop codons to the right (3&#8217;) of the
potential start codons in the +2 reading frame, as we can see from
the picture produced by plotPotentialStartsAndStops() above.</p>
</div>
<div class="section" id="predicting-the-protein-sequence-for-an-orf">
<h2>Predicting the protein sequence for an ORF<a class="headerlink" href="chapter7.html#predicting-the-protein-sequence-for-an-orf" title="Permalink to this headline">¶</a></h2>
<p>If you find an ORF in a DNA sequence, it is interesting to find the
DNA sequence of the ORF. For example, the function findORFsinSeq()
indicates that there is an ORF from nucleotides 4-12 of the
sequence <em>s1</em> (aaaatgcagtaacccatgccc). To look at the DNA sequence
for just the ORF, we can use the substring() function to cut out
that piece of DNA. For example, to cut out the substring of
sequence <em>s1</em> that corresponds to the ORF from nucleotides 4-12, we
type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> s1 <span class="o">&lt;-</span> <span class="s">&quot;aaaatgcagtaacccatgccc&quot;</span>
<span class="o">&gt;</span> myorf <span class="o">&lt;-</span> <span class="kp">substring</span><span class="p">(</span>s1<span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">12</span><span class="p">)</span>
<span class="o">&gt;</span> myorf <span class="c1"># Print out the sequence of &quot;myorf&quot;</span>
  <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;atgcagtaa&quot;</span>
</pre></div>
</div>
<p>As you can see, the ORF starts with a predicted start codon (ATG),
is followed by an integer number of codons (just one codon, CAG, in
this case), and ends with a predicted stop codon (TAA).</p>
<p>If you have the DNA sequence of an ORF, you can predict the protein
sequence for the ORF by using the translate() function from the
SeqinR package. Note that as there is a function called translate()
in both the Biostrings and SeqinR packages, we need to type
seqinr::translate() to specify that we want to use the SeqinR
translate() function.</p>
<p>The translate() function requires that the input sequence be in the
form of a vector of characters. If your sequence is in the form of
a string of characters, you can convert it to a vector of
characters using the s2c() function from the SeqinR package. For
example, to predict the protein sequence of the ORF <em>myorf</em>, you
would type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> myorfvector <span class="o">&lt;-</span> s2c<span class="p">(</span>myorf<span class="p">)</span> <span class="c1"># Convert the sequence of characters to a vector</span>
<span class="o">&gt;</span> myorfvector               <span class="c1"># Print out the value of &quot;myorfvector&quot;</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span>
<span class="o">&gt;</span> seqinr<span class="o">::</span>translate<span class="p">(</span>myorfvector<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;M&quot;</span> <span class="s">&quot;Q&quot;</span> <span class="s">&quot;*&quot;</span>
</pre></div>
</div>
<p>From the output of the seqinr::translate() function, we see that
the predicted start codon (ATG) is translated as a Methionine (M),
and that this is followed by a Glutamine (Q). The predicted stop
codon is represented as &#8220;*&#8221; as it is not translated into any amino
acid.</p>
</div>
<div class="section" id="finding-open-reading-frames-on-the-reverse-strand-of-a-dna-sequence">
<h2>Finding open reading frames on the reverse strand of a DNA sequence<a class="headerlink" href="chapter7.html#finding-open-reading-frames-on-the-reverse-strand-of-a-dna-sequence" title="Permalink to this headline">¶</a></h2>
<p>Genes in a genome sequence can occur either on the forward (plus)
strand of the DNA, or on the reverse (minus) strand. To find ORFs
on the reverse strand of a sequence, we must first infer the
reverse strand sequence, and then use our findORFsinSeq() function
to find ORFs on the reverse strand.</p>
<p>The reverse strand sequence easily can be inferred from the forward
strand sequence, as it is always the reverse complement sequence of
the forward strand sequence. We can use the comp() function from
the SeqinR package to calculate the complement of a sequence, and
the rev() function to reverse that sequence in order to give us the
reverse complement sequence.</p>
<p>The comp() and rev() functions require that the input sequence is
in the form of a vector of characters. The s2c() function can be
used to convert a sequence in the form of a string of characters to
a vector, while the c2s() function is useful for convering a vector
back to a string of characters.</p>
<p>For example, if our forward strand
sequence is &#8220;AAAATGCTTAAACCATTGCCC&#8221;, and we want to find the
reverse strand sequence, we type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> forward <span class="o">&lt;-</span> <span class="s">&quot;AAAATGCTTAAACCATTGCCC&quot;</span>
<span class="o">&gt;</span> forwardvector <span class="o">&lt;-</span> s2c<span class="p">(</span>forward<span class="p">)</span>                <span class="c1"># Convert the string of characters to a vector</span>
<span class="o">&gt;</span> forwardvector                                <span class="c1"># Print out the vector containing the forward strand sequence</span>
 <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;T&quot;</span> <span class="s">&quot;G&quot;</span> <span class="s">&quot;C&quot;</span> <span class="s">&quot;T&quot;</span> <span class="s">&quot;T&quot;</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;C&quot;</span> <span class="s">&quot;C&quot;</span> <span class="s">&quot;A&quot;</span> <span class="s">&quot;T&quot;</span> <span class="s">&quot;T&quot;</span> <span class="s">&quot;G&quot;</span> <span class="s">&quot;C&quot;</span> <span class="s">&quot;C&quot;</span> <span class="s">&quot;C&quot;</span>
<span class="o">&gt;</span> reversevector <span class="o">&lt;-</span> <span class="kp">rev</span><span class="p">(</span>comp<span class="p">(</span>forwardvector<span class="p">))</span>    <span class="c1"># Find the reverse strand sequence, by finding the reverse complement</span>
<span class="o">&gt;</span> reversevector                                <span class="c1"># Print out the vector containing the reverse strand sequence</span>
 <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;g&quot;</span> <span class="s">&quot;c&quot;</span> <span class="s">&quot;a&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span> <span class="s">&quot;t&quot;</span>
<span class="o">&gt;</span> reverse <span class="o">&lt;-</span> c2s<span class="p">(</span>reversevector<span class="p">)</span>                <span class="c1"># Convert the vector to a string of characters</span>
<span class="o">&gt;</span> reverse                                      <span class="c1"># Print out the string of characters containing the reverse strand sequence</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;gggcaatggtttaagcatttt&quot;</span>
</pre></div>
</div>
<p>In the command reversevector &lt;- rev(comp(forwardvector)) above, we
are first using the comp() function to find the complement of the
forward strand sequence. We are then using the rev() function to
take the output sequence given by comp() and reverse the order of
the letters in that sequence. An equivalent way of doing the same
thing would be to type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> complement <span class="o">&lt;-</span> comp<span class="p">(</span>forwardvector<span class="p">)</span>            <span class="c1"># Find the complement of the forward strand sequence</span>
<span class="o">&gt;</span> reversevector <span class="o">&lt;-</span> <span class="kp">rev</span><span class="p">(</span>complement<span class="p">)</span>             <span class="c1"># Reverse the order of the letters in sequence &quot;complement&quot;, to</span>
                                                  <span class="c1"># find the reverse strand sequence (the reverse complement sequence)</span>
</pre></div>
</div>
<p>Once we have inferred the reverse strand sequence, we can then use
the findORFsinSeq() function to find ORFs in the reverse strand
sequence:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> findORFsinSeq<span class="p">(</span>reverse<span class="p">)</span>
<span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">6</span>

<span class="p">[[</span><span class="m">2</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">14</span>

<span class="p">[[</span><span class="m">3</span><span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">9</span>
</pre></div>
</div>
<p>This indicates that there is one ORF of length 9 bp in the reverse
strand of sequence &#8220;AAAATGCTTAAACCATTGCCC&#8221;, that has a predicted start codon that
starts at nucleotide 6 in the reverse strand sequence and a
predicted stop codon that ends at nucleotide 14 in the reverse
strand sequence.</p>
</div>
<div class="section" id="lengths-of-open-reading-frames">
<h2>Lengths of open reading frames<a class="headerlink" href="chapter7.html#lengths-of-open-reading-frames" title="Permalink to this headline">¶</a></h2>
<p>As you can see from the picture displaying the genetic code made
using tablecode() (above), three of the 64 different codons are
stop codons. This means that in a random DNA sequence the
probability that any codon is a potential stop codon is 3/64, or
about 1/21 (about 5%).</p>
<p>Therefore, you might expect that sometimes
potential start and stop codons can occur in a DNA sequence just
due to chance alone, not because they are actually part of any real
gene that is transcribed and translated into a protein.</p>
<p>As a result, many of the ORFs in a DNA sequence may not correspond to
real genes, but just be stretches of DNA between potential start
and stop codons that happened by chance to be found in the
sequence.</p>
<p>In other words, an open reading frame (ORF) is just a
<em>gene prediction</em>, or a potential gene. It may correspond to a real
gene (may be a true positive gene prediction), but it may not (may
be a false positive gene prediction).</p>
<p>How can we tell whether the potential start and stop codons of an
ORF are probably real start and stop codons, that is, whether an
ORF probably corresponds to a real gene that is transcribed and
translated into a protein?</p>
<p>In fact, we cannot tell using
bioinformatics methods alone (we actually need to do some lab
experiments to know), but we can make a fairly confident
prediction. We can make our prediction based on the length of the
ORF.</p>
<p>y definition, an ORF is a stretch of DNA that starts with a
potential start codon, and ends with a potential stop codon in the
same reading frame, and so has no internal stop codons in that
reading frame. Because about 1/21 of codons (~5%) in a random DNA
sequence are expected to be potential stop codons just by chance
alone, if we see a very long ORF of hundreds of codons, it would be
surprising that there would be no internal stop codons in such a
long stretch of DNA if the ORF were not a real gene.</p>
<p>In other
words, long ORFs that are hundreds of codons long are unlikely to
occur due to chance alone, and therefore we can be fairly confident
that such long ORFs probably correspond to real genes.</p>
</div>
<div class="section" id="identifying-significant-open-reading-frames">
<h2>Identifying significant open reading frames<a class="headerlink" href="chapter7.html#identifying-significant-open-reading-frames" title="Permalink to this headline">¶</a></h2>
<p>How long does an ORF need to be in order for us to be confident
that it probably corresponds to a real gene? This is a difficult
question.</p>
<p>One approach to answer this is to ask: what is the
longest ORF found in a random sequence of the same length and
nucleotide composition as our original sequence?</p>
<p>The ORFs in a
random sequence do not correspond to real genes, but are just due
to potential start and stop codons that have occurred by chance in
those sequences (since, by definition, a random sequence is one
that was generated randomly, rather than by evolution as in a real
organism).</p>
<p>Thus, by looking at the lengths of ORFs in the random
sequence, we can see what is the longest ORF that is likely to
occur by chance alone.</p>
<p>But where can we get random sequences from? In a <a class="reference external" href="chapter4.html#calculating-the-statistical-significance-of-a-pairwise-global-alignment">previous chapter</a>,
you learnt that you can generate random sequences using a
multinomial model with a particular probability of each letter (a
particular probability of A, C, G, and T in the case of random DNA
sequences).</p>
<p>In that <a class="reference external" href="chapter4.html#calculating-the-statistical-significance-of-a-pairwise-global-alignment">previous chapter</a>,
we used the function generateSeqsWithMultinomialModel() to generate random sequences
using a multinomial model in which the probability of each letter is set equal to the
fraction of an input sequence that consists of that letter. This
function takes two arguments, the input sequence, and the number of
the random sequences that you want to generate.</p>
<p>For example, to create a random sequence of the same length as
&#8216;AAAATGCTTAAACCATTGCCC&#8217;, using a multinomial model in which the
probabilities of A, C, G and T are set equal to their fractions in
this sequence, we copy and paste the generateSeqsWithMultinomialModel() into R, then type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> myseq    <span class="o">&lt;-</span> <span class="s">&quot;AAAATGCTTAAACCATTGCCC&quot;</span>
<span class="o">&gt;</span> generateSeqsWithMultinomialModel<span class="p">(</span>myseq<span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="c1"># Generate one random sequence using the multinomial model</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s">&quot;AACAATTCTACCCTATTCTTC&quot;</span>
</pre></div>
</div>
<p>We can then use the findORFsinSeq() function to find ORFs in this
random sequence. If we repeat this 10 times, we can find the
lengths of the ORFs found in the 10 random sequences. We can then
compare the lengths of the ORFs found in the original sequence, to
the lengths of the ORFs found in the random sequences.</p>
<p>For example,
to compare the lengths of ORFs found in the DEN-1 Dengue virus genome
sequence <em>dengueseq</em> to the lengths of ORFs found in 10 random
sequences generated using a multinomial model in which the
probabilities of the four bases are set equal to their fractions in
the DEN-1 Dengue virus sequence, we type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> dengueseqstring <span class="o">&lt;-</span> c2s<span class="p">(</span>dengueseq<span class="p">)</span>           <span class="c1"># Convert the Dengue sequence to a string of characters</span>
<span class="o">&gt;</span> mylist <span class="o">&lt;-</span> findORFsinSeq<span class="p">(</span>dengueseqstring<span class="p">)</span>    <span class="c1"># Find ORFs in &quot;dengueseqstring&quot;</span>
<span class="o">&gt;</span> orflengths <span class="o">&lt;-</span> mylist<span class="p">[[</span><span class="m">3</span><span class="p">]]</span>                   <span class="c1"># Find the lengths of ORFs in &quot;dengueseqstring&quot;</span>
<span class="o">&gt;</span> randseqs <span class="o">&lt;-</span> generateSeqsWithMultinomialModel<span class="p">(</span>dengueseqstring<span class="p">,</span> <span class="m">10</span><span class="p">)</span> <span class="c1"># Generate 10 random sequences using the multinomial model</span>
<span class="o">&gt;</span> randseqorflengths <span class="o">&lt;-</span> <span class="kt">numeric</span><span class="p">()</span>              <span class="c1"># Tell R that we want to make a new vector of numbers</span>
<span class="o">&gt;</span> <span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="kp">print</span><span class="p">(</span>i<span class="p">)</span>
     randseq <span class="o">&lt;-</span> randseqs<span class="p">[</span>i<span class="p">]</span>                     <span class="c1"># Get the ith random sequence</span>
     mylist <span class="o">&lt;-</span> findORFsinSeq<span class="p">(</span>randseq<span class="p">)</span>           <span class="c1"># Find ORFs in &quot;randseq&quot;</span>
     lengths <span class="o">&lt;-</span> mylist<span class="p">[[</span><span class="m">3</span><span class="p">]]</span>                     <span class="c1"># Find the lengths of ORFs in &quot;randseq&quot;</span>
     randseqorflengths <span class="o">&lt;-</span> <span class="kp">append</span><span class="p">(</span>randseqorflengths<span class="p">,</span> lengths<span class="p">,</span> after<span class="o">=</span><span class="kp">length</span><span class="p">(</span>randseqorflengths<span class="p">))</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>This may take a little time to run, however, the for loop above
prints out the value of <em>i</em> each time that it starts the loop, so
you can see how far it has got.</p>
<p>In the code above, we retrieve the
lengths of the ORFs found by function findORFsinSeq() by taking the
third element of the list returned by this function. As mentioned
above, the third element of the list returned by this function is a
vector containing the lengths of all the ORFs found in the input
sequence.</p>
<p>We can then plot a histogram of the lengths of the ORFs in the real
DEN-1 Dengue genome sequence (<em>orflengths</em>) beside a
histogram of the lengths of the ORFs in the 10 random sequences
(<em>randseqorflengths</em>):</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> par<span class="p">(</span>mfrow <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>                      <span class="c1"># Make a picture with two plots side-by-side (one row, two columns)</span>
<span class="o">&gt;</span> bins <span class="o">&lt;-</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">11000</span><span class="p">,</span><span class="m">50</span><span class="p">)</span>                  <span class="c1"># Set the bins for the histogram</span>
<span class="o">&gt;</span> hist<span class="p">(</span>randseqorflengths<span class="p">,</span> breaks<span class="o">=</span>bins<span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1000</span><span class="p">))</span>
<span class="o">&gt;</span> hist<span class="p">(</span>orflengths<span class="p">,</span> breaks<span class="o">=</span>bins<span class="p">,</span> col<span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span> xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1000</span><span class="p">))</span>
</pre></div>
</div>
<p><img alt="image5" src="../_images/P7_image5b.png" /></p>
<p>In other words, the histogram of the lengths of the ORFs in the 10
random sequences gives us an idea of the length distribution of
ORFs that you would expect by chance alone in a random DNA sequence
(generated by a multinomial model in which the probabilities of the
four bases are set equal to their frequencies in the DEN-1 Dengue
virus genome sequence).</p>
<p>We can calculate the longest of the ORFs that occurs in the random
sequences, using the max() function, which can be used to find the
largest element in a vector of numbers:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> <span class="kp">max</span><span class="p">(</span>randseqorflengths<span class="p">)</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">342</span>
</pre></div>
</div>
<p>This indicates that the longest ORF that occurs in the random
sequences is 342 nucleotides long. Thus, it is possible for an ORF
of up to 342 nucleotides to occur by chance alone in a random
sequence of the same length and roughly the same composition as the
DEN-1 Dengue virus genome.</p>
<p>Therefore, we could use 342
nucleotides as a threshold, and discard all ORFs found in the
DEN-1 Dengue virus genome that are shorter than this, under the
assumption that they probably arose by chance and probably do not
correspond to real genes. How many ORFs would be left in the
DEN-1 Dengue virus genome sequence if we used 342 nucleotides as
a threshold?</p>
<div class="highlight-r"><div class="highlight"><pre>&gt; summary(orflengths &gt; 342)
     Mode   FALSE    TRUE    NA&#39;s
  logical     115       1       0
</pre></div>
</div>
<p>If we did use 342 nucleotides as a threshold, there would only be
1 ORF left in the DEN-1 Dengue virus genome. Some of the 115
shorter ORFs that we discarded may correspond to real genes.</p>
<p>Generally, we don&#8217;t want to miss many real genes, we may want to
use a more tolerant threshold. For example, instead of discarding
all Dengue ORFs that are shorter than the longest ORF found in the
10 random sequences, we could discard all Dengue ORFs that are
shorter than the longest 99% of ORFs in the random sequences.</p>
<p>We can use the quantile() function to find <em>quantiles</em> of a set of
numbers. The <em>99th</em> quantile for a set of numbers is the value <em>x</em>
such that 99% of the numbers in the set have values less than <em>x</em>.</p>
<p>For example, to find the 99th quantile of <em>randomseqorflengths</em>, we
type:</p>
<div class="highlight-r"><div class="highlight"><pre><span class="o">&gt;</span> quantile<span class="p">(</span>randseqorflengths<span class="p">,</span> probs<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0.99</span><span class="p">))</span>
<span class="m">99</span>%
<span class="m">248.07</span>
</pre></div>
</div>
<p>This means that 99% of the ORFs in the random sequences have
lengths less than 248 nucleotides long. In other words, the longest
of the longest 99% of ORFs in the random sequences is 248
nucleotides.</p>
<p>Thus, if we were using this as a threshold, we would
discard all ORFs from the DEN-1 Dengue genome that are 248
nucleotides or shorter. This will result in fewer ORFs being
discarded than if we used the more stringent threshold of 342
nucleotides (ie. discarding all ORFs of &lt;342 nucleotides), so we
will probably have discarded fewer ORFs that correspond to real
genes. Unfortunately, it probably means that we will also have kept
more false positives at the same time, that is, ORFs that do not
correspond to real genes.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="chapter7.html#summary" title="Permalink to this headline">¶</a></h2>
<p>In this practical, you will have learnt to use the following R
functions:</p>
<ol class="arabic simple">
<li>substring() for cutting out a substring of a string of
characters (eg. a subsequence of a DNA sequence)</li>
<li>rev() for reversing the order of the elements in a vector</li>
<li>hist() to make a histogram plot</li>
<li>max() to find the largest element in a vector of numbers</li>
<li>quantile() to find quantiles of a set of numbers that correspond
to particular probabilities</li>
</ol>
<p>All of these functions belong to the standard installation of R.</p>
<p>You have also learnt the following R functions that belong to the
bioinformatics packages:</p>
<ol class="arabic simple">
<li>tablecode() in the SeqinR package for viewing the genetic code</li>
<li>MatchPattern() in the Biostrings package for finding all
occurrences of a motif in a sequence</li>
<li>translate() in the SeqinR package to get the predicted protein
sequence for an ORF</li>
<li>s2c() in the SeqinR package to convert a sequence stored as a
string of characters into a vector</li>
<li>c2s() in the SeqinR package to convert a sequence stored in a
vector into a string of characters</li>
<li>comp() in the SeqinR package to find the complement of a DNA
sequence</li>
</ol>
</div>
<div class="section" id="links-and-further-reading">
<h2>Links and Further Reading<a class="headerlink" href="chapter7.html#links-and-further-reading" title="Permalink to this headline">¶</a></h2>
<p>Some links are included here for further reading.</p>
<p>For background reading on computational gene-finding, it is
recommended to read Chapter 2 of
<em>Introduction to Computational Genomics: a case studies approach</em>
by Cristianini and Hahn (Cambridge University Press;
<a class="reference external" href="http://www.computational-genomics.net/book/">www.computational-genomics.net/book/</a>).</p>
<p>For more in-depth information and more examples on using the SeqinR
package for sequence analysis, look at the SeqinR documentation,
<a class="reference external" href="http://pbil.univ-lyon1.fr/software/seqinr/doc.php?lang=eng">http://pbil.univ-lyon1.fr/software/seqinr/doc.php?lang=eng</a>.</p>
<p>For more information on and examples using the Biostrings package,
see the Biostrings documentation at
<a class="reference external" href="http://www.bioconductor.org/packages/release/bioc/html/Biostrings.html">http://www.bioconductor.org/packages/release/bioc/html/Biostrings.html</a>.</p>
<p>There is also a very nice chapter on &#8220;Analyzing Sequences&#8221;, which
includes examples of using the SeqinR and Biostrings packages for
sequence analysis, in the book
<em>Applied statistics for bioinformatics using R</em> by Krijnen
(available online at
<a class="reference external" href="http://cran.r-project.org/doc/contrib/Krijnen-IntroBioInfStatistics.pdf">cran.r-project.org/doc/contrib/Krijnen-IntroBioInfStatistics.pdf</a>).</p>
<p>For a more in-depth introduction to R, a good online tutorial is
available on the &#8220;Kickstarting R&#8221; website,
<a class="reference external" href="http://cran.r-project.org/doc/contrib/Lemon-kickstart/">cran.r-project.org/doc/contrib/Lemon-kickstart</a>.</p>
<p>There is another nice (slightly more in-depth) tutorial to R
available on the &#8220;Introduction to R&#8221; website,
<a class="reference external" href="http://cran.r-project.org/doc/manuals/R-intro.html">cran.r-project.org/doc/manuals/R-intro.html</a>.</p>
</div>
<div class="section" id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="chapter7.html#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Many of the ideas for the examples and exercises for this practical
were inspired by the Matlab case study on the
<em>Haemophilus influenzae</em> genome
(<a class="reference external" href="http://www.computational-genomics.net/case_studies/haemophilus_demo.html">www.computational-genomics.net/case_studies/haemophilus_demo.html</a>)
from the website that accompanies the book
<em>Introduction to Computational Genomics: a case studies approach</em>
by Cristianini and Hahn (Cambridge University Press;
<a class="reference external" href="http://www.computational-genomics.net/book/">www.computational-genomics.net/book/</a>).</p>
<p>Thank you to Jean Lobry and Simon Penel for helpful advice on using
the SeqinR package.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="chapter7.html#exercises" title="Permalink to this headline">¶</a></h2>
<p>Answer the following questions, using the R package. For each
question, please record your answer, and what you typed into R to
get this answer.</p>
<p>Model answers to the exercises are given in
<a class="reference external" href="chapter_answers.html#computational-gene-finding">Answers to the exercises on Computational Gene-finding</a>.</p>
<p>Q1. How many ORFs are there on the forward strand of the DEN-1 Dengue virus genome (NCBI accession NC_001477)?</p>
<p>Q2. What are the coordinates of the rightmost (most 3&#8217;, or last) ORF in the forward strand of the DEN-1 Dengue virus genome?</p>
<p>Q3. What is the predicted protein sequence for the rightmost (most 3&#8217;, or last) ORF in the forward strand of the DEN-1 Dengue virus genome?</p>
<p>Q4. How many ORFs are there of 30 nucleotides or longer in the forward strand of the DEN-1 Dengue virus genome sequence?</p>
<p>Q5. How many ORFs longer than 248 nucleotides are there in the forward strand of the DEN-1 Dengue genome sequence?</p>
<p>Q6. If an ORF is 248 nucleotides long, what length in amino acids will its predicted protein sequence be?</p>
<dl class="docutils">
<dt>Q7. How many ORFs are there on the forward strand of the rabies virus genome (NCBI accession NC_001542)?</dt>
<dd>Note: rabies virus is the virus responsible for <a class="reference external" href="http://www.who.int/rabies/en/">rabies</a>, which is classified by the
WHO as a neglected tropical disease.</dd>
</dl>
<p>Q8. What is the length of the longest ORF among the 99% of longest ORFs in 10 random sequences of the same lengths and composition as
the rabies virus genome sequence?</p>
<p>Q9. How many ORFs are there in the rabies virus genome that are longer than the threshold length that you found in Q8?</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="chapter9.html" title="Comparative Genomics"
             >next</a> |</li>
        <li class="right" >
          <a href="revisionexercises2.html" title="REVISION EXERCISES 2"
             >previous</a> |</li>
        <li><a href="https://a-little-book-of-r-for-bioinformatics.readthedocs.org/en/latest/index.html">Bioinformatics 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Avril Coghlan, Licence: Creative Commons Attribution 3.0 License.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>